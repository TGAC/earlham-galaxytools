# Introduction

This tutorial uses GeneSeqToFamily a Galaxy workflow published by Thanki et al. (2018). The goal of this workflow was to investigate “Discovery and Visualisation of Homologous Genes and Gene Families Using Galaxy”

## GeneSeqToFamily workflow

GeneSeqToFamily workflow can be downloaded from Galaxy ToolShed or from GitHub and then can be inported into local Galaxy or [public instance](usegalaxy.eu).


# Importing dataset

### Hands-on: Data upload
1. Make sure you have an empty analysis history. Give it a name.
### Tip: Starting a new history
* Click the gear icon at the top of the history panel
* Select the option Create New from the menu


2. Import Sample Data
* FASTA file:  [`CDS.fasta`](https://doi.org/10.5281/zenodo.1256760)
* JSON file: [`gene.json`](https://doi.org/10.5281/zenodo.1256762)
* Species tree: [`species.nhx`](https://doi.org/10.5281/zenodo.1256753)
### Tip: Importing data via links
* Copy the link locations
* Open the Galaxy Upload Manager
* Select Paste/Fetch Data
* Paste the link into the text field
* Press Start
### Tip: Change the file type text to nhx once the data file is in your history
Click on the pencil button displayed in your data file in the history
* Choose Datatype on the top
* Select nhx
* Press save

### 
	Rename the dataset to “First dataset”

By default, when data is imported via its link, Galaxy names it with its URL.

# Data Preparation

To convert uploaded data into the format acceptable by GeneSeqToFamily workflow:

## GeneSeqToFamily preparation 
GeneSeqToFamily preparation is an open-source tool that converts genomic information in GFF/JSON format to SQLite format for easy access during the workflow, it also adds species information in Fasta header.

### Hands-on: GeneSeqToFamily preparation : Run GeneSeqToFamily preparation on the imported GFF/JSON and Fasta files
1. GeneSeqToFamily preparation 
* Select JSON and/or GFFs files
* Add specific species name (in-case of GFFs)
* Select All Fasta Files 
* Keep Longest CDS per gene: Yes
* Change the header line of the FASTA sequences to the >TranscriptId_species format: Yes
* Comma-separated list of region IDs (e.g. chromosomes or scaffolds) for which FASTA sequences should be filtered:
* Run tool



# Running workflow

1. GeneSeqToFamily workflow 
* Select CDS file generated using GeneSeqToFamily preparation tool
* Select Gene Feature information, SQLite generated using GeneSeqToFamily preparation tool
* Select species tree, 
  * Species tree can be generated using the `ete_species_tree` generator tool
* Run the workflow


# Visualisation

## Aequatus visualisation Plugin 

The SQLite database generated by the GAFA tool can be rendered using a new visualization plugin, Aequatus.js. The Aequatus.js library, developed as part of the Aequatus project, has been configured to be used within Galaxy to visualize homologous gene structure and gene family relationships. 

### Hands-on: Aequatus visualization plugin 
1. Aequatus visualisation Plugin 
* In the history panel, expand the dataset generated by the previous step
* Choose GeneTree from side panel
* Visualise different GeneTrees



# Conclusion


Here we covered the various steps of the GeneSeqToFamily workflow. In this tutorial we used the default parameters for the workflow steps. They might need to be changed for different sources of data.

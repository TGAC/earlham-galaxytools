/**
 * Created by IntelliJ IDEA.
 * User: thankia
 * Date: 2/2/12
 * Time: 2:50 PM
 * To change this template use File | Settings | File Templates.
 */

(function($) {
  'use strict';
  $.fn.glyph = function(options) {
    var defaults = {entity:'&#9632;',color:'#000',size:'100%',left:'5px',top:'0',align:'top',lineheight:'0',position:'relative',favicon:false,domain:false}, options_extended = $.extend(defaults, options);
    return this.each(function() {
      var glyph, image = new Image(), url = 'http://www.google.com/s2/favicons?domain=', html;
      if (options_extended.favicon || options_extended.domain) {
        $(image).css({verticalAlign:options_extended.align});
        if (options_extended.domain) {
          url += options_extended.domain.replace(/((\w)*:\/\/)?/gi, '').replace(/\//gi, '');
          $(image).attr('src', url);
        }
        else {
          $(image).attr('src', options_extended.favicon);
          $(image).attr('onclick', options_extended.onClick);
        }
        glyph = $(image)[0];
      }
      else {
        glyph = options_extended.entity;
      }
      html = $('<span />').addClass('glyph').css({color:options_extended.color,fontSize:options_extended.size,left:options_extended.left,top:options_extended.top,lineHeight:options_extended.lineheight,position:options_extended.position,fontStyle:'normal',fontWeight:'normal'}).append(glyph);
      $($('*', this).get().reverse()).each(function() {
        if ($(this).is('p') || $(this).is('li') || $(this).is('dd')) {
          $(this).append('&nbsp;').append(html[0]);
          return false;
        }
      });
    });
  };
}(jQuery));

